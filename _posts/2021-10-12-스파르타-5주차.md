---
layout: post
title: ìŠ¤íŒŒë¥´íƒ€ ì½”ë”©í´ëŸ½ ê°œë°œì¼ì§€_5ì£¼ì°¨
subheading:
author: kimcno3
categories: sparta
tags:  sparta
---

> ìˆ˜ì—… ëª©í‘œ
> 1. Flask í”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•´ì„œ APIë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
> 2. 'ë§ˆì´ í˜ì´ë³´ë¦¿ ë¬´ë¹„ìŠ¤íƒ€'ë¥¼ ì™„ì„±í•œë‹¤.
> 3. EC2ì— ë‚´ í”„ë¡œì íŠ¸ë¥¼ ì˜¬ë¦¬ê³ , ìë‘í•œë‹¤!

## 1. ë¬´ë¹„ìŠ¤íƒ€ 
***
- ì¢‹ì•„ìš” ë§ì€ ìˆœìœ¼ë¡œ ì˜í™”ë°°ìš°ì˜ ì´ë¦„, ì‚¬ì§„, ì†Œê°œurl, ìµœê·¼ ì‘í’ˆ ë‚´ìš© ê²Œì‹œ
- ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ë©´ ìˆ«ì 1 ì¶”ê°€
- ì‚­ì œí•˜ê¸°ë¥¼ ëˆ„ë¥´ë©´ í•´ë‹¹ ì˜í™”ë°°ìš° ëª©ë¡ì€ ì‚­ì œ

### 1-1 DB ë§Œë“¤ê¸°(ë°ì´í„°ìŒ“ê¸°)
- í•„ìš”í•œ ì˜í™”ë°°ìš°ì˜ ë°ì´í„°ë¥¼ ë„¤ì´ë²„ ì˜í™” í˜ì´ì§€ì—ì„œ í¬ë¡¤ë§
#### 1) ë°ì´í„° ìŠ¤í¬ë˜í•‘
```python
    import requests
    from bs4 import BeautifulSoup

    from pymongo import MongoClient

    client = MongoClient('localhost', 27017)

    # DBì— ì €ì¥í•  ì˜í™”ì¸ë“¤ì˜ ì¶œì²˜ urlì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
    def get_urls():
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
        data = requests.get('https://movie.naver.com/movie/sdb/rank/rpeople.nhn', headers=headers)

        soup = BeautifulSoup(data.text, 'html.parser')

        trs = soup.select('#old_content > table > tbody > tr')

        urls = []
        for tr in trs:
            a = tr.select_one('td.title > a')
            if a is not None:
                base_url = 'https://movie.naver.com/'
    db = client.dbsparta
                url = base_url + a['href']
                urls.append(url)

        return urls

    # ì¶œì²˜ urlë¡œë¶€í„° ì˜í™”ì¸ë“¤ì˜ ì‚¬ì§„, ì´ë¦„, ìµœê·¼ì‘ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  mystar ì½œë ‰ì…˜ì— ì €ì¥í•©ë‹ˆë‹¤.
    # 'insert_all' í•¨ìˆ˜ì—ì„œ ê°™ì€ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ìœ„í•´ urlì„ ë³€ìˆ˜ë¡œ ì§€ì •
    def insert_star(url):
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
        data = requests.get(url, headers=headers)

        soup = BeautifulSoup(data.text, 'html.parser')

        name = soup.select_one('#content > div.article > div.mv_info_area > div.mv_info.character > h3 > a').text
        img_url = soup.select_one('#content > div.article > div.mv_info_area > div.poster > img')['src']
        recent_work = soup.select_one(
            '#content > div.article > div.mv_info_area > div.mv_info.character > dl > dd > a:nth-child(1)').text

        doc = {
            'name': name,
            'img_url': img_url,
            'recent': recent_work,
            'url': url,
            'like': 0
        }

        db.mystar.insert_one(doc)
        print('ì™„ë£Œ!', name)

    # ê¸°ì¡´ mystar ì½œë ‰ì…˜ì„ ì‚­ì œí•˜ê³ , ì¶œì²˜ urlë“¤ì„ ê°€ì ¸ì˜¨ í›„, í¬ë¡¤ë§í•˜ì—¬ DBì— ì €ì¥í•©ë‹ˆë‹¤.
    def insert_all():
        db.mystar.drop()  # mystar ì½œë ‰ì…˜ì„ ëª¨ë‘ ì§€ì›Œì¤ë‹ˆë‹¤.
        urls = get_urls()
        for url in urls:
            insert_star(url)

    ### ì‹¤í–‰í•˜ê¸°
    insert_all()
```
#### 2) ì™„ì„± í™•ì¸í•˜ê¸°
- mongoDBì— ì €ì¥ëœ ë°ì´í„°ë“¤
![](https://images.velog.io/images/kimcno3/post/c3b50c82-289f-4ebf-b6da-b28859889a71/05_moviestar01.JPG)

### 1-2 GET ì—°ìŠµ(ë³´ì—¬ì£¼ê¸°)
- DBì— ì €ì¥ëœ ì˜í™”ë°°ìš° ì •ë³´ë¥¼ ê³„íšì— ë§ê²Œ ê²Œì‹œí•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€
#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„ ì½”ë“œ : `app.py`

```python
    @app.route('/api/list', methods=['GET'])
    def show_stars():
        sample_receive = request.args.get('sample_give')
        print(sample_receive)
        return jsonify({'msg': 'list ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!'})
```

- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ : `index.html`

```jsx
    $(document).ready(function () {
       // ìƒˆë¡œê³ ì¹¨í•˜ê³  'list ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!' ê°€ alert ì°½ì— ë‚˜ì˜¤ë©´ ì—°ê²° ì„±ê³µ
        showStar(); 
    });

    function showStar() {
          $.ajax({
              type: 'GET',
              url: '/api/list?sample_give=ìƒ˜í”Œë°ì´í„°',
              data: {},
              success: function (response) {
                  alert(response['msg']);
              }
          });
      }
```
### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
``` py
    @app.route('/api/list', methods=['GET'])
    def show_stars():
        stars = list(db.mystar.find({}, {'_id': False}).sort("like", -1)) 
        # .sort() : like ê°’ì„ ì—­ìˆœìœ¼ë¡œ ì •ë ¬í•˜ë¼ëŠ” í•¨ìˆ˜
        return jsonify({'stars': stars})
```
#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
```jsx
    function showStar() {
                    $.ajax({
                        type: 'GET',
                        url: '/api/list',
                        data: {},
                        success: function (response) {
                            let stars = response['stars']
                            for (let i = 0; i <stars.length; i++) {
                                let img_url = stars[i]['img_url']
                                let like = stars[i]['like']
                                let name = stars[i]['name']
                                let recent = stars[i]['recent']
                                let url = stars[i]['url']
								// ë°°ìš° ì†Œê°œë°•ìŠ¤ ì½”ë“œì— DBë¡œë¶€í„° ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ëŒ€ì…
                                let temp_html = `<div class="card" id="star_media">
                                                    <div class="card-content" >
                                                        <div class="media">
                                                            <div class="media-left">
                                                                <figure class="image is-48x48">
                                                                    <img
                                                                            src="${img_url}"
                                                                            alt="Placeholder image"
                                                                    />
                                                                </figure>
                                                            </div>
                                                            <div class="media-content">
                                                                <a href="${url}" target="_blank" class="star-name title is-4">${name}(ì¢‹ì•„ìš”:
                                                                    ${like})</a>
                                                                <p class="subtitle is-6">${recent}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <footer class="card-footer">
                                                        <a href="#" onclick="likeStar('${name}')" class="card-footer-item has-text-info">
                                                            ìœ„ë¡œ!<span class="icon"><i class="fas fa-thumbs-up"></i></span>
                                                        </a>
                                                        <a href="#" onclick="deleteStar('${name}')" class="card-footer-item has-text-danger">
                                                            ì‚­ì œ<span class="icon"><i class="fas fa-ban"></i></span>
                                                        </a>
                                                    </footer>
                                                </div>`
                                $('#star-box').append(temp_html)
                            }
                        }
                    });
                }
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- ë‚˜ì—´ë˜ëŠ” ì˜í™”ë°°ìš° ë¦¬ìŠ¤íŠ¸
![](https://images.velog.io/images/kimcno3/post/fc6e68da-dc92-4e35-99a7-9667f9963a63/05_moviestar02.JPG)

### 1-3 POST ì—°ìŠµ(ì¢‹ì•„ìš” +1)
- ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ë©´ ì¢‹ì•„ìš” ê°œìˆ˜ê°€ ì¶”ê°€(DB ë‚´ 'Like' +1)
#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„ ì½”ë“œ : `app.py`
```python
     @app.route('/api/like', methods=['POST'])
    def like_star():
        name_receive = request.form['name_give']

        target_star = db.mystar.find_one({'name': name_receive})
        current_like = target_star['like']

        new_like = current_like + 1

        db.mystar.update_one({'name': name_receive}, {'$set': {'like': new_like}})

        return jsonify({'msg': 'ì¢‹ì•„ìš” ì™„ë£Œ!'})
```

- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ : `index.html`

```jsx
    function likeStar(name) {
        $.ajax({
            type: 'POST',
            url: '/api/like',
            data: {name_give:name},
            success: function (response) {
                alert(response['msg']);
                window.location.reload()
            }
        });
    }
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
```py
    @app.route('/api/like', methods=['POST'])
    def like_star():
        name_receive = request.form['name_give']

	# ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ì˜í™”ë°°ìš°ë¥¼ DBì—ì„œ ê°€ì ¸ì˜¨ë‹¤.
        target_star = db.mystar.find_one({'name': name_receive})
    	# í˜„ì¬ ì¢‹ì•„ìš” ìˆ˜ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
        current_like = target_star['like']
    	# í˜„ì¬ ì¢‹ì•„ìš” ìˆ˜ì— +1ì„ í•´ì¤€ë‹¤.
        new_like = current_like + 1
    	# ì¶”ê°€í•œ ì¢‹ì•„ìš” ìˆ˜ë¥¼ DBì— ì—…ë°ì´íŠ¸í•œë‹¤.
        db.mystar.update_one({'name': name_receive}, {'$set': {'like': new_like}})

        return jsonify({'msg': 'ì¢‹ì•„ìš” ì™„ë£Œ!'})
```
#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
```jsx
// temp_htmlì— í¬í•¨ëœ ì¢‹ì•„ìš”, ì‚­ì œí•˜ê¸° ë²„íŠ¼ ì½”ë“œ , DBì—ì„œ ê°€ì ¸ì˜¨ nameê°’ì„ ë³€ìˆ˜ë¡œ ë°›ëŠ”ë‹¤.
<footer class="card-footer">
  <a href="#" onclick="likeStar('${name}')" class="card-footer-item has-text-info">ìœ„ë¡œ!<span class="icon"><i class="fas fa-thumbs-up"></i></span> </a>
  <a href="#" onclick="deleteStar('${name}')" class="card-footer-item has-text-danger">ì‚­ì œ<span class="icon"><i class="fas fa-ban"></i></span></a>
</footer>

		â
    
    function likeStar(name) {
                    $.ajax({
                        type: 'POST',
                        url: '/api/like',
                      // name ë³€ìˆ˜ì— ë“¤ì–´ì˜¨ ê°’ì„ name_give ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì„œë²„ì— ì „ì†¡ , ì „ì†¡ì´ ì˜ ë˜ë©´(success) ì„œë²„ë¡œë¶€í„° return ê°’ì„ response ì´ë¦„ìœ¼ë¡œ ë°›ì•„ì™€ í•¨ìˆ˜ ì‹¤í–‰
                        data: {name_give:name}, 
                      // ì„œë²„ì—ì„œ ì œëŒ€ë¡œ ë°ì´í„°ë¥¼ ë°›ì•˜ë‹¤ë©´ success ì‹¤í–‰, ì„œë²„ë¡œë¶€í„° return ê°’ì„ response ì´ë¦„ìœ¼ë¡œ ë°›ì•„ì™€ í•¨ìˆ˜ ì‹¤í–‰
                        success: function (response) { 
                            alert(response['msg']); // ë©”ì„¸ì§€ê°’ alert
                            window.location.reload(); // í˜ì´ì§€ ë¦¬ë¡œë“œ

                        }
                    });
     }
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- ì •ìƒì ìœ¼ë¡œ ì‘ë™í–ˆë‹¤ëŠ” alert ë©”ì„¸ì§€
![](https://images.velog.io/images/kimcno3/post/16b98277-6d7c-4d6e-94d2-3ae65e1181c0/05_moviestar03.JPG)
- ì¶”ê°€ëœ ì¢‹ì•„ìš” ìˆ˜ì™€ ì¢‹ì•„ìš” ìˆœìœ¼ë¡œ ì¬ì •ë ¬ë˜ëŠ” ë¦¬ìŠ¤íŠ¸
![](https://images.velog.io/images/kimcno3/post/1da5d943-cd9a-4265-80db-8a1c629a1f70/05_moviestar04.JPG)
### 1-4 POST ì—°ìŠµ(ì‚­ì œí•˜ê¸°)
- ì‚­ì œí•˜ê¸°ë¥¼ ëˆ„ë¥´ë©´ í•´ë‹¹ ì˜í™”ë°°ìš° ë°ì´í„° ì „ë¶€ ì‚­ì œ(drop)
#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„ ì½”ë“œ : `app.py`
```python
    @app.route('/api/delete', methods=['POST'])
    def delete_star():
        sample_receive = request.form['sample_give']
        print(sample_receive)
        return jsonify({'msg': 'delete ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!'})
```

- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ : `index.html`

```jsx
    function deleteStar(name) {
        $.ajax({
            type: 'POST',
            url: '/api/delete',
            data: {sample_give:'ìƒ˜í”Œë°ì´í„°'},
            success: function (response) {
                alert(response['msg']);
            }
        });
    }
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
```py
    @app.route('/api/delete', methods=['POST'])
    def delete_star():
    	# ë¸Œë¼ìš°ì €ì—ì„œ ë³´ë‚´ì¤€ ë°ì´í„°(postë°©ì‹ì€ data ë”•ì…”ë„ˆë¦¬ì— ì…ë ¥)ë¥¼ ë°›ì•„ì™€ ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤
        name_receive = request.form['name_give'] 
        # DBì— ì €ì¥
        db.mystar.delete_one({'name': name_receive}) 
        # ìœ„ ê³¼ì •ì´ ì™„ë£Œë˜ë©´ returnê°’ ì „ì†¡
        return jsonify({'msg': 'ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!!'})
```
#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
```jsx
    // temp_htmlì— í¬í•¨ëœ ì¢‹ì•„ìš”, ì‚­ì œí•˜ê¸° ë²„íŠ¼ ì½”ë“œ , DBì—ì„œ ê°€ì ¸ì˜¨ nameê°’ì„ ë³€ìˆ˜ë¡œ ë°›ëŠ”ë‹¤.
    <footer class="card-footer">
      <a href="#" onclick="likeStar('${name}')" class="card-footer-item has-text-info">ìœ„ë¡œ!<span class="icon"><i class="fas fa-thumbs-up"></i></span> </a>
      <a href="#" onclick="deleteStar('${name}')" class="card-footer-item has-text-danger">ì‚­ì œ<span class="icon"><i class="fas fa-ban"></i></span></a>
    </footer>

		â
        
    function deleteStar(name) {
          $.ajax({
              type: 'POST',
              url: '/api/delete',
              data: {name_give:name},
              success: function (response) {
                  alert(response['msg']);
                  window.location.reload()
              }
          });
      }
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- ì‚­ì œë²„íŠ¼ í´ë¦­ í›„ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆë‹¤ëŠ” alert ì°½
![](https://images.velog.io/images/kimcno3/post/545feff0-7ad0-44f4-b77b-5ab7d94211bb/05_moviestar05.JPG)
- ì¬ë¡œë”© í›„ ì‚­ì œëœ ë°°ìš° ë¦¬ìŠ¤íŠ¸(ìºë¦¬ í›„ì¿ ë‚˜ê°€)
![](https://images.velog.io/images/kimcno3/post/13a36514-ab5d-4532-b75e-498568224f4c/05_moviestar06.JPG)

## 2. ì›¹ ì„œë¹„ìŠ¤ ëŸ°ì¹­
***
### 2-1 ì›¹ ì„œë¹„ìŠ¤ ëŸ°ì¹­ ê¸°ë³¸ ê°œë…
- **ì›¹ ì„œë¹„ìŠ¤ ëŸ°ì¹­** : ëˆ„êµ¬ë‚˜ ë‚´ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•œ ì‘ì—…
- ì¦‰, ì–¸ì œë‚˜ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ì‘ë‹µí•´ ì¤„ ì¤€ë¹„ê°€ ë˜ì–´ìˆì–´ì•¼ í•œë‹¤.
- ì–¸ì œë‚˜ ìš”ì²­ì— ì‘ë‹µí•˜ë ¤ë©´, ì•„ë˜ **ë‘ê°€ì§€ ì¡°ê±´**ì´ ì„±ë¦½ë˜ì–´ì•¼ í•œë‹¤.
	1) ì»´í“¨í„°ê°€ í•­ìƒ ì¼œì ¸ìˆê³  í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰
	2) ëª¨ë‘ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê³µê°œ ì£¼ì†Œì¸ ê³µê°œ IP ì£¼ì†Œ(Public IP Address)ë¡œ ë‚˜ì˜ ì›¹ ì„œë¹„ìŠ¤ì— ì ‘ê·¼ ê°€ëŠ¥í•œ ìƒíƒœ
- ìš°ë¦¬ëŠ” AWS ë¼ëŠ” í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œ í¸í•˜ê²Œ ì„œë²„ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ì„œ í•­ìƒ ì¼œ ë†“ì„ ìˆ˜ ìˆëŠ” ì»´í“¨í„°ì¸ EC2 ì‚¬ìš©ê¶Œì„ êµ¬ì…í•´ ì„œë²„ë¡œ ì‚¬ìš©í•  ê²ƒì´ë‹¤. 

### 2-2 ì›¹ ì„œë¹„ìŠ¤ ëŸ°ì¹­ ì ˆì°¨ ë° ì„¸ë¶€ ë‚´ìš©
#### 1) AWS EC2ì„œë²„ êµ¬ë§¤ 
- EC2ì„œë²„ë€? 
: Amazon Elastic Compute Cloud(Amazon EC2)ì˜ ì•½ìë¡œ Amazon Web Services(AWS) í´ë¼ìš°ë“œì—ì„œ í™•ì¥ ê°€ëŠ¥ ì»´í“¨íŒ… ìš©ëŸ‰ì„ ì œê³µí•˜ëŠ” ê²ƒì„ ì˜ë¯¸

- EC2ë¥¼ êµ¬ë§¤í•˜ë©´ ê°€ìƒ ì»´í“¨íŒ… ê¸°ìˆ ì„ í†µí•´ ì›ê²© ì„œë²„ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.(êµ¬ë§¤ì ˆì°¨ ìƒëµ)
#### 2) EC2 ì„œë²„ì— ì ‘ì†
- ì ‘ì† ì „, SSH(Secure Shell Protocol)ë€?
    - ë‹¤ë¥¸ ì»´í“¨í„°ì— ì ‘ì†í•  ë•Œ ì“°ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ ë‹¤ë¥¸ ê²ƒë“¤ ë³´ë‹¤ ë³´ì•ˆì´ ìƒëŒ€ì ìœ¼ë¡œ ë›°ì–´ë‚˜ë‹¤.
    - ì ‘ì†í•  ì»´í“¨í„°ì˜ 22ë²ˆ í¬íŠ¸ê°€ ì—´ë ¤ìˆì–´ì•¼ ì ‘ì† ê°€ëŠ¥í•˜ë©° AWS EC2ì˜ ê²½ìš°, ì´ë¯¸ 22ë²ˆ í¬íŠ¸ë¥¼ ì—´ì–´ë†“ëŠ”ë‹¤.
- gitbash(Windowì˜ ê²½ìš° SSHê°€ ì—†ì–´ì„œ ì´ë¥¼ ëŒ€ì²´í•˜ëŠ” í”„ë¡œê·¸ë¨)
```bash
    	ssh -i ë°›ì€í‚¤í˜ì–´ë¥¼ëŒì–´ë‹¤ë†“ê¸° ubuntu@AWSì—ì íŒë‚´ì•„ì´í”¼
	
    	ì˜ˆ) ì•„ë˜ì™€ ë¹„ìŠ·í•œ ìƒê¹€ìƒˆ!
	ssh -i /path/my-key-pair.pem ubuntu@13.125.250.20
```
- ê¸°ë³¸ ë¦¬ëˆ…ìŠ¤ ì–¸ì–´(ì¼ì¢…ì˜ ë§ˆìš°ìŠ¤ ì—­í• )
```bash
    ls: ë‚´ ìœ„ì¹˜ì˜ ëª¨ë“  íŒŒì¼ì„ ë³´ì—¬ì¤€ë‹¤.

    pwd: ë‚´ ìœ„ì¹˜(í´ë”ì˜ ê²½ë¡œ)ë¥¼ ì•Œë ¤ì¤€ë‹¤.

    mkdir: ë‚´ ìœ„ì¹˜ ì•„ë˜ì— í´ë”ë¥¼ í•˜ë‚˜ ë§Œë“ ë‹¤.

    cd [ê°ˆ ê³³]: ë‚˜ë¥¼ [ê°ˆ ê³³] í´ë”ë¡œ ì´ë™ì‹œí‚¨ë‹¤.

    cd .. : ë‚˜ë¥¼ ìƒìœ„ í´ë”ë¡œ ì´ë™ì‹œí‚¨ë‹¤.

    cp -r [ë³µì‚¬í•  ê²ƒ] [ë¶™ì—¬ë„£ê¸° í•  ê²ƒ]: ë³µì‚¬ ë¶™ì—¬ë„£ê¸°

    rm -rf [ì§€ìš¸ ê²ƒ]: ì§€ìš°ê¸°

    sudo [ì‹¤í–‰ í•  ëª…ë ¹ì–´]: ëª…ë ¹ì–´ë¥¼ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•œë‹¤.
    sudo su: ê´€ë¦¬ê°€ ê¶Œí•œìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤. (ë‚˜ì˜¬ ë•ŒëŠ” exitìœ¼ë¡œ ë‚˜ì˜´)
```
#### 3) ì„œë²„ í™˜ê²½ í†µì¼ (initial íŒŒì¼ ìŠ¤í¬ë© í•˜ê³  ì½”ë“œë³„ ì„¤ëª…)	
``` bash
    # UTC to KST : í•œêµ­ì‹œê°„ ì„¸íŒ… 
    sudo ln -sf /usr/share/zoneinfo/Asia/Seoul /etc/localtime

    # python3 -> python : python3 ëª…ë ¹ì–´ë¥¼ pythonìœ¼ë¡œ ë³€ê²½
    sudo update-alternatives --install /usr/bin/python python /usr/bin/python3 10

    # pip3 -> pip : pip3 ëª…ë ¹ì–´ë¥¼ pipìœ¼ë¡œ ë³€ê²½
    sudo apt-get update
    sudo apt-get install -y python3-pip
    pip3 --version
    sudo update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 1

    # port forwarding : http ê¸°ë³¸ í¬íŠ¸ì¸ 80í¬íŠ¸ë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ 5000í¬íŠ¸ë¡œ ìë™ìœ¼ë¡œ ë„˜ê²¨ì£¼ëŠ” ê°œë…
    # 'IPì£¼ì†Œ:5000'ì—ì„œ ':5000'ì„ ìƒëµì‹œí‚¤ê¸° ìœ„í•œ ì‘ì—…
    sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 5000

    # MongoDB - install : MongoDBë¥¼ ì›ê²© ì„œë²„ì— ì„¤ì¹˜
    wget -qO - https://www.mongodb.org/static/pgp/server-4.4.asc | sudo apt-key add -
    echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.4 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.4.list
    sudo apt-get update
    sudo apt-get install -y mongodb-org

    sudo mkdir -p /data/db

    # MongoDB - run : MongoDB ì‹¤í–‰
    sudo service mongod start
    sleep 7
    netstat -tnlp

    # MongoDB set user, set conf file : mongoDB ì ‘ì† ê³„ì • ìƒì„±í•˜ê¸°
    # adminìœ¼ë¡œ ê³„ì • ë³€ê²½ ë° ê³„ì • ìƒì„±(ID,PW : test)í•˜ê¸°
    mongo admin --eval 'db.createUser({user: "test", pwd: "test", roles:["root"]});'
    sudo sh -c 'echo "security:\n  authorization: enabled" >> /etc/mongod.conf'
    sudo sed -i "s,\\(^[[:blank:]]*bindIp:\\) .*,\\1 0.0.0.0," /etc/mongod.conf

    sudo service mongod stop
    sudo service mongod start
    sleep 5
    netstat -tnlp
    
    # flask íŒ¨í‚¤ì§€ ì„¤ì¹˜ : app.py ì‹¤í–‰ì„ ìœ„í•´ í•„ìˆ˜ì 
    pip install flask
```

#### 4) AWSì—ì„œ í¬íŠ¸ ì—´ì—¬ì£¼ê¸°
- EC2 ì„œë²„(=ê°€ìƒì˜ ë‚´ ì»´í“¨í„°)ì—ì„œ í¬íŠ¸ë¥¼ ë”°ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒ ì™¸ì—ë„, AWS EC2ì—ì„œë„ ìì²´ì ìœ¼ë¡œ í¬íŠ¸ë¥¼ ì—´ê³ /ë‹«ì„ ìˆ˜ ìˆê²Œ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.
	â†’ ê·¸ë˜ì„œ AWS EC2 Security Groupì—ì„œ ì¸ë°”ìš´ë“œ ìš”ì²­ í¬íŠ¸ë¥¼ ì—´ì–´ì¤˜ì•¼ ì„œë²„ë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë‹¤.
- EC2 Security Group ì—ì„œ ì•„ë˜ 3ê°œì˜ í¬íŠ¸ ì¶”ê°€
	
    - 80í¬íŠ¸(ê¸°ë³¸ http í¬íŠ¸)
    - 5000í¬íŠ¸(flask ê¸°ë³¸í¬íŠ¸)
    - 27017í¬íŠ¸(ì™¸ë¶€ì—ì„œ mongoDB ì ‘ì†ì„ í•˜ê¸° ìœ„í•œ í¬íŠ¸) 

#### 5) ì›í˜ì´ì§€ ì‡¼í•‘ëª° ì—…ë¡œë“œí•˜ê¸°
- mongoDB ëª…ë ¹ì–´ ìˆ˜ì •
```python
	# ê¸°ì¡´ ëª…ë ¹ì–´ : localhostë¡œ ì ‘ì†
	client = MongoClient('localhost', 27017)

	# ìˆ˜ì •í•œ ëª…ë ¹ì–´ : ì›ê²© ì„œë²„ë¡œ ì ‘ì†
	# ì•„ì´ë”” : test , ë¹„ë°€ë²ˆí˜¸ : test
	client = MongoClient('mongodb://ì•„ì´ë””:ë¹„ë°€ë²ˆí˜¸@localhost', 27017)
```
- pymongo íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
  # ì„¤ì¹˜í•˜ê¸°
  pip install pymongo
```
- `app.py` ì‹¤í–‰ 
```bash
  python app.py 
```
- ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
```bash
  http://ë‚´AWSì•„ì´í”¼:5000/
```
#### 6) nohup ì„¤ì •
- ë‚´ê°€ SSH ì ‘ì†ì„ ëŠì—ˆì„ ë•Œ ë‹¤ë¥¸ ì‚¬ëŒì´ ë‚´ê°€ ë§Œë“  ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ìˆ˜ ì—†ë‹¤ë©´ ì œëŒ€ë¡œ ëœ ì›¹ ì„œë¹„ìŠ¤ ëŸ°ì¹­ì´ë¼ ë³¼ ìˆ˜ ì—†ë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ì´ nohup ì„¤ì •ì„ í•˜ëŠ” ê²ƒì´ë‹¤.

- nohup ì„¤ì • ëª…ë ¹ì–´
  - ì›ê²© ì ‘ì†ì„ ì¢…ë£Œí•˜ë”ë¼ë„ ì„œë²„ê°€ ê³„ì† ëŒì•„ê°€ê²Œ í•˜ê¸°
  ```bash
      # ì•„ë˜ì˜ ëª…ë ¹ì–´ë¡œ ì‹¤í–‰í•˜ë©´ ëœë‹¤
      nohup python app.py &
  ```
  - ì„œë²„ ì¢…ë£Œí•˜ê¸° - ê°•ì œì¢…ë£Œí•˜ëŠ” ë°©ë²•
  ```bash
      # ì•„ë˜ ëª…ë ¹ì–´ë¡œ ë¯¸ë¦¬ pid ê°’(í”„ë¡œì„¸ìŠ¤ ë²ˆí˜¸)ì„ ë³¸ë‹¤
      ps -ef | grep 'app.py'

      # ì•„ë˜ ëª…ë ¹ì–´ë¡œ íŠ¹ì • í”„ë¡œì„¸ìŠ¤ë¥¼ ì£½ì¸ë‹¤
      # pidê°’ : 5ìë¦¬ ìˆ«ìì¡°í•© ì¤‘ ì•ì— ë‘ê°€ì§€ ê°’
      kill -9 [pidê°’] 
  ```
  - ë‹¤ì‹œ ì¼œê¸° 
  ```bash
      nohup python app.py &
  ```

#### 7) ë„ë©”ì¸ êµ¬ì…([ê°€ë¹„ì•„](https://my.gabia.com/service#/))
- **IP ì£¼ì†Œ**
: ì»´í“¨í„°ê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ ì»´í“¨í„°ë§ˆë‹¤ ê°€ì§€ëŠ” ìˆ«ìë¡œ êµ¬ì„±ëœ ê³ ìœ í•œ ì£¼ì†Œ
- **ë„ë©”ì¸(Domain)**
: ì‚¬ëŒì´ ì•Œì•„ë³´ê¸° ì‰½ê²Œ IPì£¼ì†Œë¥¼ ì•ŒíŒŒë²³ìœ¼ë¡œ ë°”ê¾¼ ì£¼ì†Œ
![ë„ë©”ì¸ & IP](https://sitechecker.pro/wp-content/uploads/2019/09/domain-to-ip.jpg)
- ê°€ë¹„ì•„ì—ì„œ êµ¬ì…í•œ url([kimcno3.shop](http://kimcno3.shop/))ì„ EC2ì„œë²„ IPì™€ ì—°ê²°í•˜ë©´ ì™„ë£Œ!!
#### 8) og íƒœê·¸ ì„¤ì •
- í”„ë¡œì íŠ¸ë¥¼ snsì— ê³µìœ í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ê°„ëµí•œ ì„¤ëª… í˜¹ì€ ì´ë¯¸ì§€ë¥¼ ogíƒœê·¸ë¼ê³  í•œë‹¤.
- ogíƒœê·¸ ì„¤ì • ë°©ë²•
``` jsx
    // head íƒœê·¸ ì•ˆì— ì•„ë˜ íƒœê·¸ë¥¼ ì¶”ê°€, content ê°’ì„ ì›í•˜ëŠ” ëŒ€ë¡œ ìˆ˜ì •
    // img íŒŒì¼ì€ static í´ë” ì•ˆì— ì €ì¥(800X400 ì‚¬ì´ì¦ˆ)
    <meta property="og:title" content="ë‚˜ë§Œì˜ ì‡¼í•‘ëª°" />
    <meta property="og:description" content="ë§›ìˆëŠ” ì‚¬ê³¼ì‚¬ì„¸ìš”~~ğŸ" />
    <meta property="og:image" content="{{ url_for('static', filename='ogimage.png') }}" />
```
- ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ í•œ í”„ë¡œì íŠ¸ ëª¨ìŠµ
![](https://images.velog.io/images/kimcno3/post/98ed1eb9-1f06-43f0-a9bd-8eeb37428d5d/05_aws01.JPG)

## 3. ìµœì¢… í”„ë¡œì íŠ¸ ì™„ì„±ë³¸
***
**ë§í¬ : http://kimcno3.shop/**
