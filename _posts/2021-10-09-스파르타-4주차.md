---
layout: post
title: ìŠ¤íŒŒë¥´íƒ€ ì½”ë”©í´ëŸ½ ê°œë°œì¼ì§€_4ì£¼ì°¨
subheading:
author: kimcno3
categories: sparta
tags:  sparta
---

> **ìˆ˜ì—… ëª©í‘œ**
> 1. Flask í”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•´ì„œ APIë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
> 2. 'ëª¨ë‘ì˜ì±…ë¦¬ë·°' APIë¥¼ ë§Œë“¤ê³  í´ë¼ì´ì–¸íŠ¸ì— ì—°ê²°í•œë‹¤.
> 3. 'ë‚˜í™€ë¡œë©”ëª¨ì¥' APIë¥¼ ë§Œë“¤ê³  í´ë¼ì´ì–¸íŠ¸ì™€ ì—°ê²°í•œë‹¤.

## 1. Flask
***
- Flask í”„ë ˆì„ì›Œí¬: ì„œë²„ë¥¼ êµ¬ë™ì‹œì¼œì£¼ëŠ” í¸í•œ ì½”ë“œ ëª¨ìŒ. ì„œë²„ë¥¼ êµ¬ë™í•˜ë ¤ë©´ í•„ìš”í•œ ë³µì¡í•œ ì¼ë“¤ì„ ì‰½ê²Œ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤.
> í”„ë ˆì„ì›Œí¬ë¥¼ ì“°ì§€ ì•Šìœ¼ë©´ íƒœì–‘ì´ˆë¥¼ ë¹»ì•„ì„œ ê³ ì¶”ì¥ì„ ë§Œë“œëŠ” ê²ƒê³¼ ê°™ë‹¤.
> í”„ë ˆì„ì›Œí¬ëŠ” 3ë¶„ ìš”ë¦¬/ì†ŒìŠ¤ ì„¸íŠ¸

### 1-1 Flask ê¸°ì´ˆ - ì„œë²„ ë§Œë“¤ê¸°
#### 1) ê¸°ë³¸ ì‹¤í–‰
- app.py íŒŒì¼ì„ ë§Œë“¤ì–´ ì‹œì‘ ì½”ë“œ ë¶™ì—¬ë„£ê¸°
    ``` py
    from flask import Flask
    app = Flask(__name__)

    @app.route('/')
    def home():
       return 'This is Home!'

    if __name__ == '__main__':  
       app.run('0.0.0.0',port=5000,debug=True)
    ```
- app.py ëŠ” flask ì´ìš© ì‹œ í†µìƒì ì¸ ì„œë²„íŒŒì¼ëª…
- ì„œë²„ ì‹œì‘í•˜ëŠ” ë²•: íŒŒì¼ì„ runì‹œí‚¨ í›„, chromeì—ì„œ `http://localhost:5000/`ë¡œ ì ‘ì†í•˜ë©´ 'Hello World!' ë©”ì„¸ì§€ê°€ ë‚˜ì˜¤ë©´ì„œ ì„œë²„ ì‹¤í–‰
- ì„œë²„ ì¢…ë£Œí•˜ëŠ” ë²• : í„°ë¯¸ë„ì°½ì— ctrl + c ëˆ„ë¥´ë©´ ì„œë²„ ì¢…ë£Œ

#### 2) URL ë‚˜ëˆ ë³´ê¸°
- @app.route('/) ë¶€ë¶„ì„ ìˆ˜ì •í•´ì„œ URLì„ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.
- í•˜ì§€ë§Œ! url ë³„ë¡œ í•¨ìˆ˜ëª…ì´ ê°™ê±°ë‚˜, route('/')ë‚´ì˜ ì£¼ì†Œê°€ ê°™ìœ¼ë©´ ì•ˆë©ë‹ˆë‹¤.
    ```python
    from flask import Flask
    app = Flask(__name__)
    
    @app.route('/')
    def home():
       return 'This is Home!'
    
    @app.route('/mypage')
    def mypage():  
       return 'This is My Page!'
    
    if __name__ == '__main__':  
       app.run('0.0.0.0',port=5000,debug=True)
    ```
### 1-2 Flask ê¸°ì´ˆ - HTML íŒŒì¼ ì£¼ê¸°
#### 1) ê¸°ë³¸ í´ë” êµ¬ì¡°
- Flask ì„œë²„ë¥¼ ë§Œë“¤ ë•Œ, í•­ìƒ, í”„ë¡œì íŠ¸ í´ë” ì•ˆì—,
     **ã„´static í´ë”** (ì´ë¯¸ì§€, cssíŒŒì¼ì„ ë„£ì–´ë‘¡ë‹ˆë‹¤)
     **ã„´templates í´ë”** (htmlíŒŒì¼ì„ ë„£ì–´ë‘¡ë‹ˆë‹¤)
     **ã„´app.py íŒŒì¼**
	ì´ë ‡ê²Œ ì„¸ ê°œë¥¼ ë§Œë“¤ì–´ë‘ê³  ì‹œì‘í•˜ê¸°
	(ê¼­ ì°¸ê³ !! venvëŠ” ì‹¤ì œë¡œëŠ” ë³´ì´ì§€ë§Œ, **ì•ˆë³´ì¸ë‹¤~**ë¼ê³  ìƒê°í•˜ì„¸ìš”! ê¸°ì–µí•˜ì‹œì£ ?)
#### 2) HTML íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
**templates í´ë”ì˜ ì—­í• ** : HTML íŒŒì¼ì„ ë‹´ì•„ë‘ê³ , ë¶ˆëŸ¬ì˜¤ëŠ” ì—­í• 

1. ê°„ë‹¨í•œ index.html íŒŒì¼ì„ templates ì•ˆì— ë§Œë“¤ê¸°
    - **[ì½”ë“œìŠ¤ë‹ˆí«] index.html ì˜ˆì œì½”ë“œ**
        ```html
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <title>Document</title>
        </head>
        <body>
            <h1>ì„œë²„ë¥¼ ë§Œë“¤ì—ˆë‹¤!</h1>
        </body>
        </html>
        ```
        
2. html íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
    
    - flask ë‚´ì¥í•¨ìˆ˜ render_templateë¥¼ ì´ìš©í•˜ì—¬ index.html íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
    ```python
    from flask import Flask, render_template # í•¨ìˆ˜ ì„í¬íŠ¸
    app = Flask(__name__)
    
    ## URL ë³„ë¡œ í•¨ìˆ˜ëª…ì´ ê°™ê±°ë‚˜,
    ## route('/') ë“±ì˜ ì£¼ì†Œê°€ ê°™ìœ¼ë©´ ì•ˆë©ë‹ˆë‹¤.
    
    @app.route('/')
    def home():
       return render_template('index.html') # html íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
    
    if __name__ == '__main__':
       app.run('0.0.0.0', port=5000, debug=True)
    ```
### 1-3 Flask ê¸°ì´ˆ - ë³¸ê²© API ë§Œë“¤ê¸°
#### 1) ë“¤ì–´ê°€ê¸° ì „ì—: GET, POST ìš”ì²­íƒ€ì…(ë¦¬ë§ˆì¸ë“œ)

**ì€í–‰ì˜ ì°½êµ¬ê°€ APIì™€ ê°™ë‹¤.**
ê°™ì€ ì˜ˆê¸ˆ ì°½êµ¬ì—ì„œë„ ê°œì¸ ê³ ê°ì´ëƒ ê¸°ì—… ê³ ê°ì´ëƒì— ë”°ë¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë‹¤ë¥¸ ê²ƒì²˜ëŸ¼,

**í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ í•  ë•Œì—ë„, "ë°©ì‹"ì´ ì¡´ì¬í•©ë‹ˆë‹¤.**
HTTP ë¼ëŠ” í†µì‹  ê·œì•½ì„ ë”°ë¥¸ë‹¤ëŠ” ê±° ìŠì§€ ì•Šìœ¼ì…¨ì£ ? í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­í•  ë•Œ HTTP request method(ìš”ì²­ ë©”ì†Œë“œ)ë¥¼ í†µí•´, ì–´ë–¤ ìš”ì²­ ì¢…ë¥˜ì¸ì§€ ì‘ë‹µí•˜ëŠ” ì„œë²„ ìª½ì— ì •ë³´ë¥¼ ì•Œë ¤ì£¼ëŠ” ê±°ì—ìš”. 

**GET, POST ë°©ì‹**
ì—¬ëŸ¬ ë°©ì‹([ë§í¬](https://developer.mozilla.org/ko/docs/Web/HTTP/Methods))ì´ ì¡´ì¬í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ê°€ì¥ ë§ì´ ì“°ì´ëŠ” GET, POST ë°©ì‹ì— ëŒ€í•´ì„œë§Œ ì•Œì•„ë³´ì.
* GET        â†’      í†µìƒì ìœ¼ë¡œ! ë°ì´í„° ì¡°íšŒ(Read)ë¥¼ ìš”ì²­í•  ë•Œ
                           ì˜ˆ) ì˜í™” ëª©ë¡ ì¡°íšŒ
                  â†’     **ë°ì´í„° ì „ë‹¬** : URL ë’¤ì— ë¬¼ìŒí‘œë¥¼ ë¶™ì—¬ key=valueë¡œ ì „ë‹¬
                  â†’     ì˜ˆ: google.com?q=ë¶ê·¹ê³°

* POST     â†’      í†µìƒì ìœ¼ë¡œ! ë°ì´í„° ìƒì„±(Create), ë³€ê²½(Update), ì‚­ì œ(Delete) ìš”ì²­ í•  ë•Œ
                           ì˜ˆ) íšŒì›ê°€ì…, íšŒì›íƒˆí‡´, ë¹„ë°€ë²ˆí˜¸ ìˆ˜ì •
                  â†’     **ë°ì´í„° ì „ë‹¬ :** ë°”ë¡œ ë³´ì´ì§€ ì•ŠëŠ” HTML bodyì— key:value í˜•íƒœë¡œ ì „ë‹¬

#### 2) GET, POST ìš”ì²­ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ë°ì´í„°ë¥¼ ë°›ëŠ” ë°©ë²•
- **GET ìš”ì²­ APIì½”ë“œ**
  ```py
  @app.route('/test', methods=['GET'])
  def test_get():
	  # í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° 'title_give'ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ ì˜¨ë‹¤.
      title_receive = request.args.get('title_give') 
      print(title_receive) # ê²°ê³¼ == 'ë´„ë‚ ì€ê°„ë‹¤'
      return jsonify({'result':'success', 'msg': 'ì´ ìš”ì²­ì€ GET!'}) # ë”•ì…”ë„ˆë¦¬ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚¸ë‹¤.
  ```
    
- **GET ìš”ì²­ í™•ì¸ Ajaxì½”ë“œ**
  ```jsx
$.ajax({
      type: "GET",
      url: "/test?title_give=ë´„ë‚ ì€ê°„ë‹¤", // ë™ì¼í•œ urlì˜ ì„œë²„ë¡œ title_give=ë´„ë‚ ì€ê°„ë‹¤ ë°ì´í„° ì „ì†¡
      data: {},
      success: function (response) { // response == {'result':'success', 'msg': 'ì´ ìš”ì²­ì€ GET!'}
        let result = response['result']
        let msg = response['msg']
        console.log(result, msg) // ê²°ê³¼ == success ì´ ìš”ì²­ì€ GET!
      }
})
  ```
- **POST ìš”ì²­ APIì½”ë“œ**
  ```py
  @app.route('/test', methods=['POST'])
  def test_post():
     title_receive = request.form['title_give']
     print(title_receive)
     return jsonify({'result':'success', 'msg': 'ì´ ìš”ì²­ì€ POST!'})
  ```
- **POST ìš”ì²­ í™•ì¸ Ajaxì½”ë“œ**
    ```jsx
    $.ajax({
        type: "POST",
        url: "/test",
        data: {title_give: 'ë´„ë‚ ì€ê°„ë‹¤'},
        success: function (response) {
            let result = response['result']
            let msg = response['msg']
            console.log(result, msg)
        }
            })
    ```
## 2. ëª¨ë‘ì˜ ì±…ë¦¬ë·°
***
### 2-1 POST ì—°ìŠµ(ë¦¬ë·° ì €ì¥)
> API ì½”ë“œ ì‘ì„± í›„ DBì— ë°ì´í„° ì €ì¥í•˜ê¸°(ì œëª©, ì €ì, ë¦¬ë·°)
> ì•„ë˜ ìˆœì„œì— ë”°ë¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì™„ì„±ë„ê°€ ë†’ë‹¤.

#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  ## API ì—­í• ì„ í•˜ëŠ” ë¶€ë¶„
  @app.route('/review', methods=['POST'])
  def write_review():
      # 1. í´ë¼ì´ì–¸íŠ¸ê°€ ì¤€ title, author, review ê°€ì ¸ì˜¤ê¸°.
      ## 2. DBì— ì •ë³´ ì‚½ì…í•˜ê¸°
      # 3. ì„±ê³µ ì—¬ë¶€ & ì„±ê³µ ë©”ì‹œì§€ ë°˜í™˜í•˜ê¸°
      return jsonify({'result': 'success', 'msg': 'ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.'})
```
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
function makeReview() {
		// 1. ì œëª©, ì €ì, ë¦¬ë·° ë‚´ìš©ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
		// 2. ì œëª©, ì €ì, ë¦¬ë·° ì¤‘ í•˜ë‚˜ë¼ë„ ì…ë ¥í•˜ì§€ ì•Šì•˜ì„ ê²½ìš° alertë¥¼ ë„ì›ë‹ˆë‹¤.
		// 3. POST /review ì— ì €ì¥ì„ ìš”ì²­í•©ë‹ˆë‹¤.
    $.ajax({
        type: "POST",
        url:  "/review",
        data: { },
        success: function (response) {
            if (response["result"] == "success") {
                alert(response["msg"] ); 
              // ê²°ê³¼ê°’ìœ¼ë¡œ 'ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.'ê°€ alert ë˜ë©´ ì •ìƒì ìœ¼ë¡œ ì—°ê²°ë˜ì—ˆë‹¤ëŠ” ëœ»
                window.location.reload();
            }
        }
    })
}
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/review', methods=['POST'])
  def write_review():
      # title_receiveë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì¤€ title ê°€ì ¸ì˜¤ê¸°
      title_receive = request.form['title_give']
      # author_receiveë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì¤€ author ê°€ì ¸ì˜¤ê¸°
      author_receive = request.form['author_give']
      # review_receiveë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì¤€ review ê°€ì ¸ì˜¤ê¸°
      review_receive = request.form['review_give']

      # DBì— ì‚½ì…í•  review ë§Œë“¤ê¸°
      doc = {
          'title': title_receive,
          'author': author_receive,
          'review': review_receive
      }
      # reviewsì— review ì €ì¥í•˜ê¸°
      db.bookreview.insert_one(doc)
      # ì„±ê³µ ì—¬ë¶€ & ì„±ê³µ ë©”ì‹œì§€ ë°˜í™˜
      return jsonify({'msg': 'ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.'})
```

#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
function makeReview() {
    // í™”ë©´ì— ì…ë ¥ì–´ ìˆëŠ” ì œëª©, ì €ì, ë¦¬ë·° ë‚´ìš©ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
    let title = $("#title").val();
    let author = $("#author").val();
    let review = $("#bookReview").val();

    // POST /review ì— ì €ì¥(Create)ì„ ìš”ì²­í•©ë‹ˆë‹¤.
    $.ajax({
        type: "POST",
        url: "/review",
      	// ì„œë²„ì™€ ì•½ì†í•œ í‚¤ê°’ì— ë§ê²Œ input ë‚´ìš© ì €ì¥
        data: { title_give: title, author_give: author, review_give: review },
        success: function (response) {
            alert(response["msg"]);
            window.location.reload(); // í¬ìŠ¤íŒ… í›„ ì¬ë¡œë”© ì‹œí‚¤ê¸°
        }
    })
}
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- ì •ìƒì ìœ¼ë¡œ ì½”ë“œê°€ ì‘ë™í–ˆë‹¤ëŠ” alert ë©”ì„¸ì§€
![](https://images.velog.io/images/kimcno3/post/00563d34-786e-48c7-abd9-fdf5fd775b9b/image.png)

- mongoDBì— ì €ì¥ëœ ë°ì´í„°ì˜ ëª¨ìŠµ
![](https://images.velog.io/images/kimcno3/post/81911abe-6f86-4991-8cb1-d2544dff592a/04_review2.JPG)
### 2-2 GET ì—°ìŠµ(ë¦¬ë·° ë³´ì—¬ì£¼ê¸°)
> ë§Œë“¤ì–´ì ¸ ìˆëŠ” API ì •ë³´
> **1. ìš”ì²­ ì •ë³´** :  ìš”ì²­ URL= `/review` , ìš”ì²­ ë°©ì‹ = `GET`
> **2. ì„œë²„ê°€ ì œê³µí•  ê¸°ëŠ¥** :  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì •í•´ì§„ ë©”ì‹œì§€ë¥¼ ë³´ëƒ„
> **3. ì‘ë‹µ ë°ì´í„°  :** (JSON í˜•ì‹) {'msg': 'ì´ ìš”ì²­ì€ GET!'}

#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/review', methods=['GET'])
  def read_reviews():
      sample_receive = request.args.get('sample_give')
      print(sample_receive) // 'ìƒ˜í”Œë°ì´í„°' printë˜ë©´ ì •ìƒ ì—°ê²°
      return jsonify({'msg': 'ì´ ìš”ì²­ì€ GET!'})
```
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
  // í˜ì´ì§€ê°€ ë¡œë”©ë˜ë©´ ì•„ë˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¤ë¼ëŠ” í•¨ìˆ˜
  $(document).ready(function () {
  	showReview(); 
  });

  function showReview() {
          // ì„œë²„ì˜ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ê¸°
          $.ajax({
          type: "GET",
          url: "/review?sample_give=ìƒ˜í”Œë°ì´í„°",
          data: {},
          success: function (response) {
              alert(response["msg"]); 
            // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ì„ alertì°½ì´ ëœ¨ë©´ ì •ìƒì ìœ¼ë¡œ ì—°ê²°ëœ ê²ƒ 
          }
      })
  }
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/review', methods=['GET'])
  def read_reviews():
      # 1. DBì—ì„œ ë¦¬ë·° ì •ë³´ ëª¨ë‘ ê°€ì ¸ì˜¤ê¸°
      reviews = list(db.bookreview.find({}, {'_id': False}))
      ## 2. ì„±ê³µ ì—¬ë¶€ & ë¦¬ë·° ëª©ë¡ ë°˜í™˜í•˜ê¸°
      return jsonify({'all_reviews': reviews})
```

#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
function showReview() {
                $.ajax({
                    type: "GET",
                    url: "/review",
                    data: {},
                    success: function (response) {
                      	// ì„œë²„ê°€ ë³´ë‚´ì¤€ ë°ì´í„° ì´ë¦„ì¸ all_reviews
                        let reviews = response['all_reviews']
                        // ë°˜ë³µë¬¸ì„ í†µí•´ ì›í•˜ëŠ” ë°ì´í„°ê°’ ë¶„ë¥˜
                        for (let i = 0; i < reviews.length; i++) {
                            let title = reviews[i]['title']
                            let author = reviews[i]['author']
                            let review = reviews[i]['review']
						// ì¶”ê°€í•  html ì½”ë“œì–‘ì‹ ìƒì„±
                            let temp_html = `<tr>
                                                <td>${title}</td>
                                                <td>${author}</td>
                                                <td>${review}</td>
                                            </tr>`
                            $('#reviews-box').append(temp_html)
                        }
                    }
                })
            }
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°

- í˜ì´ì§€ ë¡œë”© í›„ ìë™ì ìœ¼ë¡œ ì¶”ê°€ë˜ì–´ ë³´ì—¬ì§€ëŠ” ë¦¬ë·° ë¦¬ìŠ¤íŠ¸
![](https://images.velog.io/images/kimcno3/post/e1f2d96f-b9bb-4b72-9139-a6f9a0d1c2b3/04_review3.JPG)

## 3. ë‚˜í™€ë¡œ ë©”ëª¨ì¥
***
### 3-1 POST ì—°ìŠµ(ë©”ëª¨í•˜ê¸°)
> **ìš°ë¦¬ê°€ ë§Œë“¤ API ë‘ ê°€ì§€**
> **í¬ìŠ¤íŒ… API** - ì¹´ë“œ ìƒì„± (Create) : í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì€ url, commentë¥¼ ì´ìš©í•´ì„œ í˜ì´ì§€ ì •ë³´ë¥¼ ì°¾ê³  ì €ì¥í•˜ê¸° 
> **ë¦¬ìŠ¤íŒ…API** - ì €ì¥ëœ ì¹´ë“œ ë³´ì—¬ì£¼ê¸° (Read)

#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/memo', methods=['POST'])
  def post_articles():
          sample_receive = request.form['sample_give']
          print(sample_receive) # 'ìƒ˜í”Œë°ì´í„°' ê°’ì´ print ë˜ë©´ ì—°ê²° ì„±ê³µ
      return jsonify({'msg': 'POST ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!'})
```
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
function postArticle() {
  $.ajax({
    type: "POST",
    url: "/memo",
    data: {sample_give:'ìƒ˜í”Œë°ì´í„°'},
    success: function (response) {
      // ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ 'POST ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!' ê°’ì´ alert ë˜ë©´ ì—°ê²° ì„±ê³µ
      alert(response['msg']); 
    }
  })
}

<button type="button" class="btn btn-primary" onclick="postArticle()">ê¸°
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/memo', methods=['POST'])
  def saving():
      url_receive = request.form['url_give']
      comment_receive = request.form['comment_give']
      
      # í¬ë¡¤ë§ì„ ìœ„í•œ bs4 í•¨ìˆ˜
      headers = {
          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
      data = requests.get(url_receive, headers=headers)

      soup = BeautifulSoup(data.text, 'html.parser')
      
      # meta íƒœê·¸ì—ì„œ propertyê°€ og:000 ì¸ ì¤„ì˜ content ê°’ì„ ê°€ì ¸ì™€ë¼
      title = soup.select_one('meta[property="og:title"]')['content']
      image = soup.select_one('meta[property="og:image"]')['content']
      desc = soup.select_one('meta[property="og:description"]')['content']

      doc = {
          'title':title,
          'image':image,
          'desc':desc,
          'url':url_receive,
          'comment':comment_receive
      }
      
      # DBì— ì €ì¥ 
      db.articles.insert_one(doc)

      # ì •ìƒì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìœ¼ë©´ ë©”ì„¸ì§€ ê°’ ì „ì†¡ 
      return jsonify({'msg':'ì €ì¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!'})
```

#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
  function postArticle() {
    	// ì…ë ¥ëœ ê°’ ì €ì¥
        let url = $('#post-url').val()
        let comment = $('#post-comment').val()

        $.ajax({
            type: "POST",
            url: "/memo",
          	// ì„œë²„ì™€ ì•½ì†ëœ ì´ë¦„ìœ¼ë¡œ ì…ë ¥ê°’ ì „ì†¡
            data: {url_give:url, comment_give:comment},
            success: function (response) {
              //ì •ìƒì ìœ¼ë¡œ ì‘ë™í–ˆë‹¤ë©´ msgê°’ alert
                alert(response["msg"]); 
              // ì¬ ë¡œë”©
                window.location.reload()
            }
        })
    }
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- ì •ìƒì ìœ¼ë¡œ ì½”ë“œê°€ ì‘ë™í–ˆë‹¤ëŠ” alert ë©”ì„¸ì§€
![](https://images.velog.io/images/kimcno3/post/2dc3d03a-3484-40de-bda7-b22c20e9b7c9/04_memo1.JPG)
- mongoDBì— ì €ì¥ëœ ë°ì´í„°ì˜ ëª¨ìŠµ
![](https://images.velog.io/images/kimcno3/post/70bf623a-07f3-472c-bcb5-bbc708cd6b07/04_memo2.JPG)
### 3-2 GET ì—°ìŠµ(ë³´ì—¬ì£¼ê¸°)


#### 1) í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ í™•ì¸í•˜ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/memo', methods=['GET'])
  def read_articles():
      # 1. ëª¨ë“  document ì°¾ê¸° & _id ê°’ì€ ì¶œë ¥ì—ì„œ ì œì™¸í•˜ê¸°
      ## 2. articlesë¼ëŠ” í‚¤ ê°’ìœ¼ë¡œ ì˜í™”ì •ë³´ ë‚´ë ¤ì£¼ê¸°
      return jsonify({'result':'success', 'msg':'GET ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!'})
```
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
  $(document).ready(function () {
  	showArticles(); // í˜ì´ì§€ê°€ ì¤€ë¹„ë˜ë©´ ì•ˆì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰
  });

  function showArticles() {
    $.ajax({
      type: "GET",
      url: "/memo",
      data: {},
      success: function (response) {
        if (response["result"] == "success") {
          alert(response["msg"]); // í˜ì´ì§€ ë¡œë”©ê³¼ ë™ì‹œì— alertì°½ì´ ëœ¨ë©´ ì—°ê²° ì„±ê³µ
        }
      }
    })
  }
```
#### 2) ì„œë²„ë¶€í„° ë§Œë“¤ê¸°
- ì„œë²„: `app.py` ì½”ë“œ 
```py
  @app.route('/memo', methods=['GET'])
  def listing():
      # DBì— ìˆëŠ” ëª¨ë“  ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      articles = list(db.articles.find({}, {'_id': False})) 
      # all_articles ë¼ëŠ” ì´ë¦„ì˜ ë”•ì…”ë„ˆë¦¬ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì „ì†¡
      return jsonify({'all_articles':articles}) 
```

#### 3) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
- í´ë¼ì´ì–¸íŠ¸: `index.html` íŒŒì¼ ì½”ë“œ 

```jsx
  function showArticles() {
      $.ajax({
          type: "GET",
          url: "/memo",
          data: {},
          success: function (response) {
              // ì„œë²„ê°€ ë³´ë‚´ì¤€ ì´ë¦„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¤ê¸°
              let articles = response['all_articles'] 
              // ë°˜ë³µë¬¸ì„ í†µí•´ ë°ì´í„° ë¶„ë¥˜
              for (let i = 0; i < articles.length; i++) {
                  let title = articles[i]['title']
                  let image = articles[i]['image']
                  let url = articles[i]['url']
                  let desc = articles[i]['desc']
                  let comment = articles[i]['comment']

                  let temp_html = `<div class="card">
                                      <img class="card-img-top"
                                           src="${image}"
                                           alt="Card image cap">
                                      <div class="card-body">
                                          <a target="_blank" href="${url}" class="card-title">${title}</a>
                                          <p class="card-text">${desc}</p>
                                          <p class="card-text comment">${comment}</p>
                                    </div>
                                </div>`
                $('#cards-box').append(temp_html)
            }
        }
    })
}
```
#### 4) ì™„ì„± í™•ì¸í•˜ê¸°
- í¬ìŠ¤íŒ…ë˜ì–´ ìˆëŠ” ì˜í™” ì •ë³´
![](https://images.velog.io/images/kimcno3/post/34034fef-963c-42c2-91ef-04d29368277b/04_memo3.JPG)

## 4ì£¼ì°¨ ìˆ™ì œ
***
### ë‚˜ë§Œì˜ ì‡¼í•‘ëª° í˜ì´ì§€ì— flask ê¸°ëŠ¥ ì¶”ê°€
> **ì¶”ê°€í•  ê¸°ëŠ¥**
> 1. ì£¼ë¬¸ì ì •ë³´ ì €ì¥í•˜ê¸°(POST)
> 2. í™”ë©´ í•˜ë‹¨ì— ì£¼ë¬¸ì ëª…ë‹¨ ë³´ì—¬ì£¼ê¸°(GET)

#### 1) ì‚¬ìš© ì½”ë“œ
- ì„œë²„ íŒŒì¼(app.py)
```py
  from flask import Flask, render_template, jsonify, request

  app = Flask(__name__)

  from pymongo import MongoClient

  client = MongoClient('localhost', 27017)
  db = client.dbhomework


  ## HTML í™”ë©´ ë³´ì—¬ì£¼ê¸°
  @app.route('/')
  def homework():
      return render_template('index.html')


  # ì£¼ë¬¸í•˜ê¸°(POST) API
  @app.route('/order', methods=['POST'])
  def save_order():
      name_receive = request.form['name_give']
      count_receive = request.form['count_give']
      address_receive = request.form['address_give']
      phonenumber_receive = request.form['phonenumber_give']

      doc = {
          'name' : name_receive,
          'count' : count_receive,
          'address' : address_receive,
          'phonenumber' : phonenumber_receive
      }
      db.homework.insert_one(doc)

      return jsonify({'msg': 'ì£¼ë¬¸ ì™„ë£Œ!!'})


  # ì£¼ë¬¸ ëª©ë¡ë³´ê¸°(Read) API
  @app.route('/order', methods=['GET'])
  def view_orders():
      orders = list(db.homework.find({}, {'_id': False}))
      return jsonify({'order_list': orders})


  if __name__ == '__main__':
      app.run('0.0.0.0', port=5000, debug=True)
```

- í´ë¼ì´ì–¸íŠ¸ íŒŒì¼(index.html)
``` jsx
  <!doctype html>
  <html lang="en">

  <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

      <!-- Google fonts ì¶”ê°€    -->
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@700&display=swap" rel="stylesheet">

      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
          integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
          crossorigin="anonymous"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
          integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
          crossorigin="anonymous"></script>

      <title>ë‚˜ë§Œì˜ ì‡¼í•‘ëª°_ê¹€ì„ í˜¸</title>
      <style>
          * {
              font-family: 'Nanum Gothic', sans-serif;
          }
          .wrap {
              width: 700px;
              margin: 50px auto auto auto;
          }
          .img {
              width: 700px;
              height: 500px;

              background-image: url("https://images.unsplash.com/photo-1568702846914-96b305d2aaeb?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80");
              background-position: center;
              background-size: cover;

          }

          .description {
              font-size: 20px;
          }
          .description_price {
              font-weight: normal;
              font-size: 20px;

          }
          .btn-primary {
              font-size: 20px;

              display: block;
              width: auto;
              margin: auto;

              border-radius: 5px;
          }
          #dollartowon {
              color:blue;

          }
          .table {
              margin: 20px auto 20px auto;
              text-align: center;
          }
      </style>

      <script>
          $(document).ready(function () {
              dollar_to_won();
              order_listing();
          })

          function ordered() {
              let name = $('#name-text').val()
              let count = $('#count-text').val()
              let address = $('#address-text').val()
              let phonenumber = $('#phonenumber-text').val()

              $.ajax({
                  type: "POST",
                  url: "/order",
                  data: { name_give: name,
                          count_give: count,
                          address_give: address,
                          phonenumber_give: phonenumber
                  },
                  success: function (response) {
                          alert(response["msg"]);
                          window.location.reload();
                  }
              })
          }

          function order_listing() {
              $.ajax({
                  type: "GET",
                  url: "/order",
                  data: {},
                  success: function (response) {
                    // ì„œë²„ë¡œ ë¶€í„° ë°›ì•„ì˜¨ ë”•ì…”ë„ˆë¦¬ê°€ response ì•ˆì— ìˆìœ¼ë‹ˆ 'order_list'ë¡œ ë‹¤ì‹œ ë³€ìˆ˜ ì§€ì •
                      let orders = response['order_list'] 
                      for (let i=0; i<orders.length; i++) {
                          let address = orders[i]['address']
                          let count= orders[i]['count']
                          let name = orders[i]['name']
                          let phonenumber= orders[i]['phonenumber']

                          let temp_html = `<tr>
                                          <th scope="row">${name}</th>
                                          <td>${count}</td>
                                          <td>${address}</td>
                                          <td>${phonenumber}</td>
                                      </tr>`
                          $('#order-list').append(temp_html)
                      }

                  }
              })
          }
          function dollar_to_won() {
              $.ajax({
                  type: "GET",
                  url: "http://spartacodingclub.shop/sparta_api/rate",
                  data: {},
                  success: function (response) {
                      let rate = response['rate'];
                      let temp_html = `${rate}`;
                      $('#dollartowon').append(temp_html);

                  }
              })
          }
      </script>
  </head>

  <body>
      <div class="wrap">
          <div class="img"> </div>
          <div class="description">
              <h1>ì‚¬ê³¼ë¥¼ íŒë‹ˆë‹¤ <span class="description_price">ê°€ê²©: 1,000ì›/ê°œ</span></h1>
              <p>ì´ ì‚¬ê³¼ëŠ” ë¨¹ìœ¼ë©´ ê¸°ë¶„ì´ ì¢‹ì•„ì§€ëŠ” íš¨ê³¼ê°€ ìˆì–´ìš”. ì´ìœ ëŠ” ê·¸ëƒ¥ ë‹¬ê³  ë§›ìˆê±°ë“ ìš”ğŸ˜</p>
              <p>ì˜¤ëŠ˜ì˜ í™˜ìœ¨($ â†’ â‚©) : <span id="dollartowon"> </span> ì›</p>
          </div>
          <div class="orderbox">
              <div class="input-group mb-3">
                  <div class="input-group-prepend">
                      <span class="input-group-text" id="inputGroup-sizing-default">ì£¼ë¬¸ì ì´ë¦„</span>
                  </div>
                  <input type="text" id="name-text" class="form-control" aria-label="Default"
                         aria-describedby="inputGroup-sizing-default">
              </div>
              <div class="input-group mb-3">
                  <div class="input-group-prepend">
                      <label class="input-group-text" for="count-text">ê°œìˆ˜</label>
                  </div>
                  <select class="custom-select" id="count-text">
                      <option selected></option>
                      <option value="1ê°œ">1ê°œ</option>
                      <option value="3ê°œ">3ê°œ</option>
                      <option value="6ê°œ">6ê°œ</option>
                      <option value="12ê°œ">12ê°œ</option>
                  </select>
              </div>
              <div class="input-group mb-3">
                  <div class="input-group-prepend">
                      <span class="input-group-text" id="inputGroup-sizing-default">ì£¼ì†Œ</span>
                  </div>
                  <input type="text" id="address-text" class="form-control" aria-label="Default"
                         aria-describedby="inputGroup-sizing-default">
              </div>
              <div class="input-group mb-3">
                  <div class="input-group-prepend">
                      <span class="input-group-text" id="inputGroup-sizing-default">ì „í™”ë²ˆí˜¸</span>
                  </div>
                  <input type="text" id="phonenumber-text" class="form-control" aria-label="Default"
                         aria-describedby="inputGroup-sizing-default">
              </div>
              <button onclick = ordered() type="button" class="btn-primary">ì£¼ë¬¸í•˜ê¸°</button>
          </div>
          <table class="table">
              <thead>
                  <tr>
                      <th scope="col">ì£¼ë¬¸ì ì´ë¦„</th>
                      <th scope="col">ê°œìˆ˜</th>
                      <th scope="col">ì£¼ì†Œ</th>
                      <th scope="col">ì „í™”ë²ˆí˜¸</th>
                  </tr>
              </thead>
              <tbody id="order-list">

              </tbody>
          </table>
      </div>
  </body>
  </html>
```

#### 2) ì™„ì„± ëª¨ìŠµ
- ì£¼ë¬¸í•˜ê¸° ë²„íŠ¼ í´ë¦­ì‹œ ë‚˜ì˜¤ëŠ” alert ë©”ì„¸ì§€
![](https://images.velog.io/images/kimcno3/post/f75edfdd-43af-43a7-a34c-622c8d48d1c9/04_hw1.JPG)
- ì…ë ¥ëœ ë°ì´í„°ê°€ ì €ì¥ëœ DB
![](https://images.velog.io/images/kimcno3/post/4549a574-05dc-4939-a370-98acb21ef9f8/04_hw3.JPG)
- ì¶”ê°€ë˜ëŠ” ì£¼ë¬¸ì ëª©ë¡
![](https://images.velog.io/images/kimcno3/post/4ab2ec3a-1008-466a-9d90-925e1c625278/04_hw2.JPG)

